<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel de Administraci√≥n - Vitatec</title>
  <link rel="stylesheet" href="/static/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<style>
.registro-aprobado { background: lightgreen !important; }
.registro-rechazado { background: lightcoral !important; }
.modal {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5);
  display: flex; justify-content: center; align-items: center;
  z-index: 9999;
}
.modal-contenido {
  background: white;
  padding: 20px;
  border-radius: 10px;
  max-width: 500px;
  width: 90%;
}
.cerrar {
  float: right;
  font-size: 24px;
  cursor: pointer;
}
#mas {
  margin-top: 10px;
  padding: 5px 15px;
  background: #008CBA;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}
#mas:hover {
  background: #005f6a;
}
.registro {
  padding: 12px;
  margin-bottom: 8px;
  border-radius: 8px;
}

.registro-aprobado {
  border-left: 5px solid #198754;         /* verde Bootstrap fuerte */
  background-color: #cce5cc;              /* verde m√°s visible */
  color: #0b2e13;                         /* texto oscuro */
}

.registro-rechazado {
  border-left: 5px solid #dc3545;         /* rojo Bootstrap fuerte */
  background-color: #f1b0b7;              /* rojo pastel intenso */
  color: #58151c;                         /* texto rojo oscuro */
}

.registro:hover {
  background: #f0f0f0;
  cursor: pointer;
}

#modalAuditoria .modal-contenido {
  background: white;
  padding: 20px;
  border-radius: 10px;
  width: 400px;
  max-width: 90%;
}
.fila-duplicada {
  background-color: #f8d7da;  /* rojo suave */
  color: #721c24;
}
</style>

<body>
  <header>
    <h1>Dashboard de Administraci√≥n</h1>
  </header>

  <nav>
    <ul>
      <li><a href="#solicitudes">Solicitudes</a></li>
      <li><a href="#resumen">Resumen</a></li>
      <li><a href="#logs">Logs</a></li>
      <li><a href="#messages">Mensajes Enviados</a></li>
      <li><a href="#audit">Auditor√≠a</a></li>
      <li><a href="#stats">Estad√≠sticas</a></li>
      <li><a href="{{ url_for('logout') }}">Cerrar sesi√≥n</a></li>
    </ul>
  </nav>
<div id="modalDetalles" class="modal" style="display:none;">
  <div class="modal-contenido">
    <span class="cerrar" onclick="cerrarModal()">&times;</span>
    <h2>Detalles de la Solicitud</h2>
    <div id="contenidoDetalles"></div>
  </div>
</div>
<div id="modalAuditoria" class="modal" style="display:none;">
  <div class="modal-contenido">
    <span class="cerrar" onclick="cerrarAuditoriaModal()">&times;</span>
    <h2>Detalle de auditor√≠a</h2>
    <div id="contenidoAuditoria"></div>
  </div>
</div>
  <main>
  
    <!-- Secci√≥n de Solicitudes Pendientes -->
    <section id="solicitudes" class="card">
      <div class="card-header">üì• Solicitudes Pendientes de Alta</div>
      <div class="card-body">
        <table class="tabla" id="tablaSolicitudes">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Tel√©fono</th>
              <th>Email</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="solicitudesBody">
            <!-- Se rellena por JS -->
          </tbody>
        </table>
      </div>
      <div id="avisoHorario" class="bg-yellow-100 text-yellow-800 p-4 rounded-md mb-4" style="display: none;">
        ‚ö†Ô∏è Actualmente estamos fuera del horario laboral. Las solicitudes se crean autom√°ticamente y no aparecer√°n aqu√≠.
        <button onclick="toggleFueraDeHorario()" class="ml-4 px-3 py-1 bg-yellow-500 text-white rounded-md hover:bg-yellow-600">
          Ver tambi√©n fuera de horario
        </button>
      </div>
      <div id="avisoRecordatorio" class="bg-blue-100 text-blue-800 p-4 rounded-md mb-4" style="display: none;">
        ‚ùó Est√°s viendo solicitudes fuera de horario laboral. No olvides reactivar el filtro cuando termines.
      </div>

    </section>

    <!-- Resumen -->
    <section id="resumen" class="card">
      <div class="card-header">Resumen de Actividad</div>
      <div class="card-body">
        <p><strong>üìÖ Total citas hoy:</strong> <span id="citasHoy">-</span></p>
        <p><strong>‚úÖ Confirmadas:</strong> <span id="citasConfirmadas">-</span></p>
        <p><strong>‚ùå Canceladas:</strong> <span id="citasCanceladas">-</span></p>
        <p><strong>üì® Mensajes enviados:</strong> <span id="mensajesTotales">-</span></p>
      </div>
    </section>

    <!-- Secci√≥n Logs -->
    <section id="logs">
      <h2>Logs de Actividad</h2>
      <div id="logList">
        <div id="logsContainer"></div>
        <button id="mas" onclick="cargarLogs(true)">Mostrar m√°s</button>
      </div>
    </section>

    <!-- Secci√≥n Mensajes Enviados -->
    <section id="messages">
      <h2>Mensajes Enviados</h2>
      <div id="messagesList">
        <div id="messagesContainer"></div>
        <button id="masMensajes" onclick="cargarMensajes(true)">Mostrar m√°s</button>
      </div>
    </section>

    <!-- Secci√≥n Auditor√≠a -->
    <section id="audit">
      <h2>Auditor√≠a</h2>
      <div id="auditList"></div>
    </section>

    <!-- Secci√≥n Estad√≠sticas -->
    <section id="stats">
      <h2>Estad√≠sticas de Altas de pacientes</h2>

      <!-- Selector D√≠a/Mes -->
      <div style="margin-bottom: 20px;">
        <label>
          <input type="radio" name="tipoEstadistica" value="dia" checked>
          Ver por d√≠a
        </label>
        <label style="margin-left: 20px;">
          <input type="radio" name="tipoEstadistica" value="mes">
          Ver por mes
        </label>
      </div>

      <!-- Gr√°fico -->
      <canvas id="myChart" width="400" height="200"></canvas>
    </section>

  </main>

  <footer>
    <p>&copy; 2025 Vitatec. Todos los derechos reservados.</p>
  </footer>

  <script src="/static/script.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>

</body>
</html>
